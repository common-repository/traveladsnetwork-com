!function(t){var e="mousedown touchstart MSPointerDown pointerdown",i="mouseup touchend MSPointerUp pointerup",s="mousemove touchmove MSPointerMove pointermove scroll";function o(t,e,i){l("transform",t,"translate("+e+"px, "+i+"px)")}function n(t,e){l("transition",t,e)}function r(t){return t=t.originalEvent||t,window.event&&window.event.changedTouches&&event.changedTouches[0].pageX||t.pageX}function a(t){return t=t.originalEvent||t,window.event&&window.event.changedTouches&&event.changedTouches[0].pageY||t.pageY}function l(t,e,i){for(var s=(t=t.toLowerCase()).charAt(0).toUpperCase()+t.substr(1),o=["webkit","Moz","ms","O"].map(function(t){return t+s}).concat("transform"),n=0,r=o.length;n<r;++n)if(o[n]in e.style){if(void 0===i)return e.style[o[n]];e.style[o[n]]=i;break}}var h=["altKey","bubbles","button","cancelable","charCode","clientX","clientY","ctrlKey","currentTarget","data","detail","eventPhase","metaKey","offsetX","offsetY","originalTarget","pageX","pageY","relatedTarget","screenX","screenY","shiftKey","target","view","which"];function c(t,e,i,s){if(t[0]){i=i.originalEvent||i;var o={};h.forEach(function(t){o[t]=i[t]}),o.currentTarget=o.target=t[0];var n=t[0].ownerDocument.defaultView||t[0].ownerDocument.parentWindow,r=n.Zepto||n.jQuery,a=r.Event(e,o);return r(t[0]).trigger(a,s),a}}var p,d=0,f=function(){var e;this.eventHandler=t("<div />"),this.parent=this.el=this.handle=null,this.origin={x:0,y:0,transition:null,translate:null,offset:{x:0,y:0}},this.lastEntered=this.currentTarget=null,this.lastX=this.lastY=this.lastDirection=null,this.originalCss={},this.windows=[window],Object.defineProperty(this,"placeholder",{get:function(){return e},set:function(t){e!==t&&(e&&e.remove(),e=t)}})};f.prototype.on=function(){return this.eventHandler.on.apply(this.eventHandler,Array.prototype.slice.call(arguments)),this},f.prototype.off=function(){return this.eventHandler.off.apply(this.eventHandler,Array.prototype.slice.call(arguments)),this},f.prototype.start=function(e,o,h,p){this.parent=e,this.el=o,this.handle=p;o=this.handle||this.el;this.origin.x=r(h),this.origin.y=a(h),this.origin.transform=l("transform",this.el[0]),this.origin.transition=l("transition",this.el[0]);var d=this.el[0].getBoundingClientRect();return this.origin.offset.x=d.left+(window.scrollX||window.pageXOffset)-this.origin.x,this.origin.offset.y=d.top+(window.scrollY||window.pageYOffset)-this.origin.y,this.origin.scrollX=window.scrollX||window.pageXOffset,this.origin.scrollY=window.scrollY||window.pageYOffset,o[0].style.pointerEvents="none",this.windows.forEach(function(e){t(e).on(s,t.proxy(this.move,this)),t(e).on(i,t.proxy(this.stop,this))},this),n(o[0],""),c(this.eventHandler,"dragging:start",h),this.el},f.prototype.stop=function(e){if(this.last){var o=this.last;this.last=null,!c(t(o),"dragging:drop",e).isDefaultPrevented()}if(this.el){for(var r in this.originalCss)this.el.css(r,this.originalCss[r]),delete this.originalCss[r];c(this.eventHandler,"dragging:stop",e,this.el),this.placeholder=null,this.handle||this.adjustPlacement(e);var a=this.el;this.handle&&this.handle.remove(),setTimeout(function(t,e){n(t[0],"all 0.25s ease-in-out 0s"),l("transform",t[0],e.transform||""),setTimeout(n.bind(null,t[0],e.transition||""),250),t[0].style.pointerEvents=""}.bind(null,a,this.origin)),this.windows.forEach(function(e){t(e).off(s,this.move),t(e).off(i,this.stop)},this),this.parent=this.el=this.handle=null}},f.prototype.move=function(e){if(this.el){var i=(f=this.el[0].ownerDocument).defaultView||f.parentWindow;if("scroll"!==e.type){var s=r(e),n=a(e);e.view!==i&&e.view.frameElement&&(s+=e.view.frameElement.offsetLeft,n+=e.view.frameElement.offsetTop);var l,h=e.clientX||e.originalEvent&&e.originalEvent.clientX||window.event&&window.event.touches&&window.event.touches[0].clientX||0,d=e.clientY||e.originalEvent&&e.originalEvent.clientY||window.event&&window.event.touches&&window.event.touches[0].clientY||0,f=this.el[0].ownerDocument;l=v?(l=e.view.document.msElementsFromPoint(h,d))[0]===this.el[0]?l[1]:l[0]:e.view.document.elementFromPoint(h,d);var g=this.lastX-s,u=((x=this.lastY-n)>0?"up":x<0&&"down")||g>0&&"up"||g<0&&"down"||this.lastDirection;p.currentTarget||this.setCurrent(l),this.currentTarget&&(l!==this.last&&this.lastEntered!==this.currentTarget?(c(t(this.lastEntered),"dragging:leave",e),c(t(this.currentTarget),"dragging:enter",e),this.lastEntered=this.currentTarget):u!==this.lastDirection&&c(t(this.currentTarget),"dragging:diverted",e)),this.last=l,this.currentTarget=null,this.lastDirection=u,this.lastX=s,this.lastY=n,this.origin.scrollX=window.scrollX||window.pageXOffset,this.origin.scrollY=window.scrollY||window.pageYOffset}else s=this.lastX+((window.scrollX||window.pageXOffset)-this.origin.scrollX),n=this.lastY+((window.scrollY||window.pageYOffset)-this.origin.scrollY);if(e.view!==i&&e.view&&e.view.frameElement){var w=-1*(n-(window.scrollY||window.pageYOffset)-window.innerHeight),m=document.documentElement.offsetHeight<(window.scrollY||window.pageYOffset)+window.innerHeight;w<=10&&!m&&setTimeout(function(){window.scrollBy(0,5)},50);var y=n-(window.scrollY||window.pageYOffset),b=(window.scrollY||window.pageYOffset)<=0;y<=10&&!b&&setTimeout(function(){window.scrollBy(0,-5)},50)}g=s-this.origin.x;var x=n-this.origin.y;o((this.handle||this.el)[0],g,x)}},f.prototype.setCurrent=function(t){this.currentTarget=t},f.prototype.css=function(t,e){this.el&&(this.originalCss[t]=this.el.css(t),this.el.css(t,e))},f.prototype.adjustPlacement=function(t){var e=this.handle&&this.handle[0]||this.el[0];o(e,0,0);var i=e.getBoundingClientRect();this.origin.x=i.left+(window.scrollX||window.pageXOffset)-this.origin.offset.x,this.origin.y=i.top+(window.scrollY||window.pageYOffset)-this.origin.offset.y;var s=r(t)||this.lastX,n=a(t)||this.lastY;o(e,s-this.origin.x,n-this.origin.y)};try{parent.$&&parent.$.dragging&&(p=parent.$.dragging).windows.push(window)}catch(t){}p=t.dragging=p||new f;var g=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;function u(t){return Array.prototype.slice.call(t)}var v=!1;void 0===g&&((g=function(t){this.targets=[],this.onAdded=function(e){t([{addedNodes:[e.target],removedNodes:[]}])},this.onRemoved=function(e){t([{addedNodes:[],removedNodes:[e.target]}])}}).prototype.observe=function(t){t.addEventListener("DOMNodeInserted",this.onAdded),t.addEventListener("DOMNodeRemoved",this.onRemoved),this.targets.push(t)},g.prototype.disconnect=function(){for(var t;t=this.targets.shift();)t.removeEventListener("DOMNodeInserted",this.onAdded),t.removeEventListener("DOMNodeRemoved",this.onRemoved)},v=!!~navigator.appName.indexOf("Internet Explorer"));var w=function(t,e,i,s){var o=this;this.targets=t instanceof NodeList?Array.prototype.slice.call(t):[t];var n=">"===e[0],r=n?e.substr(1):e,a=!1;function l(t,i,s){var a,l,h;s&&(a=t,l=i,h=[],u(a).forEach(function(t){var i,s,a;1===t.nodeType&&(n&&-1===o.targets.indexOf(t.parentNode)||(s=r,(a=(i=t).matches||i.matchesSelector||i.msMatchesSelector||i.mozMatchesSelector||i.webkitMatchesSelector||i.oMatchesSelector)&&a.call(i,s)&&h.push(t),!n&&l&&u(t.querySelectorAll(e)).forEach(function(t){h.push(t)})))}),h).filter(function(t,e,i){return i.indexOf(t)===e}).forEach(function(t){s.call(t)})}var h=null,c=[],p=[];function d(){o.disconnect();for(var t=0,e=p.length;t<e;++t){var n=c.indexOf(p[t]);n>-1&&(c.splice(n,1),p.splice(t--,1))}l(c,!(a&&v),i),l(p,!0,s),c.length=0,p.length=0,o.observe()}this.observer=new g(function(t){t.forEach(function(t){c.push.apply(c,t.addedNodes),p.push.apply(p,t.removedNodes)}),h&&clearTimeout(h),h=setTimeout(d)}),i&&this.targets.forEach(function(t){l(t.children,!0,i)}),a=!0,this.observe()};w.prototype.disconnect=function(){this.observer.disconnect()},w.prototype.observe=function(){var t=this;this.targets.forEach(function(e){t.observer.observe(e,{childList:!0,subtree:!0})})};var m=function(e,i){this.id=d++,this.el=t(e),this.opts=i,this.cancel=!1!==i.handle};m.prototype.create=function(){this.el.on(e,t.proxy(this.start,this)).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom"),p.on("dragging:stop",t.proxy(this.reset,this));var i=this;setTimeout(function(){i.el.trigger("draggable:create",i)})},m.prototype.destroy=function(){this.el.off(e,this.start),p.off("dragging:stop",this.reset)},m.prototype.enable=function(){this.opts.disabled=!1},m.prototype.disable=function(){this.opts.disabled=!0},m.prototype.start=function(e){if(this.opts.disabled)return!1;if("mousedown"===e.type&&1!==e.which)return!1;if(e=e.originalEvent||e,this.opts.cancel)for(var i=t(e.target);i[0]!==this.el[0];){if(i.is(this.opts.cancel))return;i=i.parent()}if(this.opts.handle){i=t(e.target);for(var s=!1;i[0]!==this.el[0];){if(i.is(this.opts.handle)){s=!0;break}i=i.parent()}if(!s)return}e.preventDefault();var o;this.el;if(this.opts.clone){"function"==typeof this.opts.clone?o=this.opts.clone.call(this.el):(o=this.el.clone(),this.opts.cloneClass&&o.addClass(this.opts.cloneClass));var n=this.el.position();o.css("position","absolute").css("left",n.left).css("top",n.top).width(this.el.width()).height(this.el.height()),o.insertAfter(this.el)}p.start(this,this.el,e,o),c(this.el,"draggable:start",e,{item:p.el})},m.prototype.reset=function(t,e){e===this.el[0]&&c(this.el,"draggable:stop",t,{item:p.el})};var y=function(e,i){this.id=d++,this.el=t(e),this.opts=i,this.accept=!1};y.prototype.create=function(){this.el.on("dragging:enter",t.proxy(this.enter,this)).on("dragging:leave",t.proxy(this.leave,this)).on("dragging:drop",t.proxy(this.drop,this)),p.on("dragging:start",t.proxy(this.activate,this)).on("dragging:stop",t.proxy(this.reset,this));var e=this;setTimeout(function(){e.el.trigger("droppable:create",e)})},y.prototype.destroy=function(){this.el.off("dragging:enter",this.enter).off("dragging:leave",this.leave).off("dragging:drop",this.drop)},y.prototype.enable=function(){this.opts.disabled=!1},y.prototype.disable=function(){this.opts.disabled=!0},y.prototype.activate=function(t){if(this.accept=p.parent.opts.connectWith&&this.el.is(p.parent.opts.connectWith),!this.accept){var e="*"===this.opts.accept||("function"==typeof this.opts.accept?this.opts.accept.call(this.el[0],p.el):p.el.is(this.opts.accept));"default"!==this.opts.scope?(this.accept=p.parent.opts.scope===this.opts.scope,this.accept||"*"===this.opts.accept||(this.accept=e)):this.accept=e}this.accept&&(this.opts.activeClass&&this.el.addClass(this.opts.activeClass),c(this.el,"droppable:activate",t,{item:p.el}))},y.prototype.reset=function(t){this.accept&&(this.opts.activeClass&&this.el.removeClass(this.opts.activeClass),this.opts.hoverClass&&this.el.removeClass(this.opts.hoverClass),c(this.el,"droppable:deactivate",t,{item:p.el}))},y.prototype.enter=function(t){if(this.opts.disabled)return!1;t.stopPropagation(),p.placeholder&&p.placeholder.hide(),this.accept&&(this.opts.hoverClass&&this.el.addClass(this.opts.hoverClass),c(this.el,"droppable:over",t,{item:p.el}))},y.prototype.leave=function(t){if(this.opts.disabled)return!1;this.opts.hoverClass&&this.accept&&this.el.removeClass(this.opts.hoverClass),c(this.el,"droppable:out",t,{item:p.el})},y.prototype.drop=function(e){if(this.opts.disabled||!this.accept)return!1;if(p.el){var i=p.el,s="function"==typeof this.opts.receiveHandler&&this.opts.receiveHandler,o={item:i},n=null;p.handle&&(o.helper=p.handle,s||(n=o.clone=p.el.clone())),c(this.el,"droppable:drop",e,o).isDefaultPrevented()||(s?s.call(this.el,o):t(this.el).append(n||p.el))}};var b=function(e,i){this.id=d++,this.el=e,this.opts=i;var s=this.opts.placeholderTag;if(!s)try{s=this.el.find(this.opts.items)[0].tagName}catch(t){s=/^ul|ol$/i.test(this.el[0].tagName)?"li":"div"}this.placeholder=t("<"+s+' id="__ph'+this.id+'" class="'+this.opts.placeholder+'" />'),this.accept=this.index=this.direction=null};function x(e,i,s){return function(o,n,r){var a=[];return this.each(function(){var l=t(this).data(i);if("string"==typeof o){if(void 0===l)throw new Error(i+" not defined");switch(o){case"enable":l.enable();break;case"disable":l.disable();break;case"destroy":l.destroy(),t(this).removeData(i);break;case"option":void 0!==r?l.opts[n]=r:"object"==typeof n?l.opts=t.extend(l.opts,n):n?a.push(l.opts[n]):a.push(l.opts);break;case"toArray":if("sortable"!==i)return;a.push(l.toArray(n))}}else{if(l)return t.extend(l.opts,o),this;(l=new e(t(this),t.extend({},s,o))).create(),t(this).data(i,l)}}),a.length?1===a.length?a[0]:a:this}}b.prototype.create=function(){this.el.on(e,this.opts.items,t.proxy(this.start,this)).on("dragging:enter",this.opts.items,t.proxy(this.enter,this)).on("dragging:diverted",this.opts.items,t.proxy(this.diverted,this)).on("dragging:drop",this.opts.items,t.proxy(this.drop,this)),t(this.el).find(this.opts.items).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom"),this.el.on("dragging:enter",t.proxy(this.enter,this)).on("dragging:diverted",t.proxy(this.diverted,this)).on("dragging:drop",t.proxy(this.drop,this)),p.on("dragging:start",t.proxy(this.activate,this)).on("dragging:stop",t.proxy(this.reset,this));var i=this;setTimeout(function(){i.el.trigger("sortable:create",i)}),this.observer=new w(this.el[0],this.opts.items,function(){},function(){if(!(this===i.placeholder[0]||p.el&&this===p.el[0])){var e=t(this);e.css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom"),i.el.trigger("sortable:change",{item:e}),i.el.trigger("sortable:update",{item:e,index:-1})}})},b.prototype.destroy=function(){this.el.off(e,this.opts.items,this.start).off("dragging:enter",this.opts.items,this.enter).off("dragging:diverted",this.opts.items,this.diverted).off("dragging:drop",this.opts.items,this.drop),this.el.off("dragging:enter",this.enter).off("dragging:diverted",this.diverted).off("dragging:drop",this.drop),this.observer.disconnect()},b.prototype.enable=function(){this.opts.disabled=!1},b.prototype.disable=function(){this.opts.disabled=!0},b.prototype.activate=function(t){this.isEmpty=0===this.el.find(this.opts.items).length,this.accept=p.parent.id===this.id,!this.accept&&p.parent.opts.connectWith&&(this.accept=this.el.is(p.parent.opts.connectWith)),this.accept&&(this.accept=p.parent.id===this.id||"*"===this.opts.accept||("function"==typeof this.opts.accept?this.opts.accept.call(this.el[0],p.el):p.el.is(this.opts.accept)),this.accept&&(this.opts.activeClass&&this.el.addClass(this.opts.activeClass),c(this.el,"sortable:activate",t,{item:p.el})))},b.prototype.reset=function(t){this.accept&&(this.opts.activeClass&&this.el.removeClass(this.opts.activeClass),c(this.el,"sortable:deactivate",t,{item:p.el}),null!==this.index&&(c(this.el,"sortable:beforeStop",t,{item:p.el}),c(this.el,"sortable:stop",t,{item:p.el}),this.index=null))},b.prototype.indexOf=function(t){return this.el.find(this.opts.items+", #"+this.placeholder.attr("id")).index(t)},b.prototype.start=function(e){if(!this.opts.disabled&&!p.el){if("mousedown"===e.type&&1!==e.which)return!1;if(this.opts.cancel)for(var i=t(e.target);i[0]!==this.el[0];){if(i.is(this.opts.cancel))return;i=i.parent()}if(this.opts.handle){i=t(e.target);for(var s=!1;i[0]!==this.el[0];){if(i.is(this.opts.handle)){s=!0;break}i=i.parent()}if(!s)return}if(e.stopPropagation(),e.preventDefault(),p.start(this,t(e.currentTarget),e),this.index=this.indexOf(p.el),p.el.before(p.placeholder=this.placeholder.show()),null!==this.index){var o=p.el.outerHeight?p.el.outerHeight():p.el.height();p.css("margin-bottom",-o)}this.opts.forcePlaceholderSize&&(this.placeholder.height(parseFloat(p.el.css("height"))),this.placeholder.width(parseFloat(p.el.css("width")))),p.adjustPlacement(e),c(this.el,"sortable:start",e,{item:p.el})}},b.prototype.enter=function(e){if(this.accept&&!this.opts.disabled){e.stopPropagation();var i=e.currentTarget,s=i===this.el[0];i!==this.placeholder[0]&&(i=t(i),s&&!this.isEmpty&&this.placeholder.parent().length||(p.placeholder=this.placeholder,this.opts.forcePlaceholderSize&&(this.placeholder.height(parseFloat(p.el.css("height"))),this.placeholder.width(parseFloat(p.el.css("width")))),s?(this.el.append(this.placeholder),this.el.trigger("sortable:change",{item:p.el})):this.diverted(e)))}},b.prototype.diverted=function(e){if(this.accept&&!this.opts.disabled){e.stopPropagation();var i=t(e.currentTarget);i[0]===this.el[0]||(p.placeholder=this.placeholder,this.direction=this.indexOf(this.placeholder.show())<this.indexOf(i)?"down":"up",i["down"===this.direction?"after":"before"](this.placeholder),p.adjustPlacement(e),this.el.trigger("sortable:change",{item:p.el}))}},b.prototype.drop=function(t){if(this.accept&&!this.opts.disabled&&(t.stopPropagation(),t.preventDefault(),p.el&&this.placeholder.parent().length)){c(this.el,"sortable:beforeStop",t,{item:p.el}),this.observer.disconnect();var e,i=this.indexOf(this.placeholder);i>this.index&&i--,e=null===this.index?this.opts.receiveHandler:this.opts.updateHandler||this.opts.updatePosition;var s=p.el;"function"==typeof e?e.call(this.el,{item:p.el,index:i}):(p.handle&&(s=p.el.clone()),s.insertBefore(this.placeholder)),null===this.index&&c(this.el,"sortable:receive",t,{item:s}),i!==this.index&&this.el.trigger("sortable:update",{item:s,index:i}),c(this.el,"sortable:stop",t,{item:s}),this.index=null,this.observer.observe(),p.stop(t)}},b.prototype.toArray=function(e){e||(e={});var i=e.attribute||"id",s=[];return this.el.find(this.opts.items).each(function(){s.push(t(this).prop(i))}),s},t.fn.draggable=x(m,"draggable",{cancel:"input, textarea, button, select, option",connectWith:!1,cursor:"auto",disabled:!1,handle:!1,initialized:!1,clone:!1,cloneClass:"",scope:"default"}),t.fn.droppable=x(y,"droppable",{accept:"*",activeClass:"",disabled:!1,hoverClass:"",initialized:!1,scope:"default",receiveHandler:null}),t.fn.sortable=x(b,"sortable",{accept:"*",activeClass:"",cancel:"input, textarea, button, select, option",connectWith:!1,disabled:!1,forcePlaceholderSize:!1,handle:!1,initialized:!1,items:"li, div",placeholder:"placeholder",placeholderTag:null,updateHandler:null,receiveHandler:null})}(window.Zepto||window.jQuery);
